#une fct pour entrer a chaqye fois les param
#iddÃ©e de cache: sauvgarder le resultat et je fais une requette sauf si si j'ai pas la 
library(jsonlite)
library(tibble)

liste_1 <- paste('519188','1270260','529334','1269750','473537','569143','464176','1271231','464737','803611','2051302','563692','481725','1257986','1861387','1857578','2207349','4070245','4344544','4215307',sep =',')
liste_2 <- paste('5285039','4673179','1861060','2130037','1348747','4047656','5493998','3017680','3007202','2058430','2181258','2130135','2110681','1862845','1863250','1852699','1853163','5815135','5391891','7839407',sep =',')
liste_3 <- paste('2476412','2479183','2482939','2483761','2487620','1252738','1252744','1252773','6240770','2498775','6441676','6438569','6454050','6446231','6452039','6453748','6446218','6457368',sep =',')
liste_4 <- paste('4056099','3385122','3386567','3387266','3447473','6217081','2508813','2151649','2171000','2154855','2491335','2492345','2498752','360542','361495','362882','1252840','1252925','2426370','2427336',sep =',')
liste_5 <- paste('2166584','6943577','2065337','3471324','3456005','2425714','2192676','2184443','6232255','7533612','2176264','2181108','2206939','3469034','6217203','6241300','3451220','3455077','3453535','350789',sep =',')
liste_6 <- paste('356933','356945','356989','358095','358108','2428042','2428228','2429605','2433055','7603258','2424015','1818833','1818209','2429344','1819730','1819414','1818983','1819729','1818501','355795',sep =',')
liste_7 <- paste('1282028','1337624','1282027','6942153','1819273','1281980','1282256','1337605','1337606','1337607','1337610','1337612')

liste_cities <- c(liste_1,liste_2,liste_3,liste_4,liste_5,liste_6,liste_7)

#villes=paste('519188','1270260','529334','1269750','473537','569143','464176','1271231','464737','803611','2051302','563692','481725','1257986','1861387','1857578','2207349','4070245','4344544','4215307',sep =',')
df <- data.frame()

url1 <- paste("http://api.openweathermap.org/data/2.5/group?id=",liste_1,"&units=metric&APPID=c800fa5b7ad6c01803c180e6b8102329",sep="")
data1 <- fromJSON(url1)
print(data1)
dt1 <- data1$list$weather
dt2 <- data1$list
t1 <- as_tibble(dt1)
view(dt2)



url2 <- paste("http://api.openweathermap.org/data/2.5/group?id=",liste_2,"&units=metric&APPID=c800fa5b7ad6c01803c180e6b8102329",sep="")
data2 <- fromJSON(url2)
dt2 <- data2$list
t2 <- data.frame(dt2)
view(t)
rownames(t2) <- c("21", "22","23","24",  "25",  "26",  "27",  "28",  "29",  "30", "31", "32", "33", "34", "35", "36", "37", "38", "39", "40")
row.names(t2)
print(t2)
t2 <- as_tibble(dt2)

t <- rbind(t1,t2)
print(t)
view(t)

for (i in liste_cities){
  print(i)
  
  url <- paste("http://api.openweathermap.org/data/2.5/group?id=",liste_1,"&units=metric&APPID=c800fa5b7ad6c01803c180e6b8102329",sep="")
  print(url)
  
  data <- fromJSON(url)
  #t <- as_tibble(data)
  
  #df <- rbind(df,as.data.frame(data), unique = FALSE)
  view(as.data.frame(data))
  
}




